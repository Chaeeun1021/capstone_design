(this["webpackJsonprip-current"]=this["webpackJsonprip-current"]||[]).push([[0],{131:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(14),c=a.n(l),o=(a(57),a(35)),s=a(6),i=(a(58),a(47)),m=a.n(i),u=a(26);a(71),a(72);var d=Object(n.memo)(e=>{let{src:t,coordinates:a=[],onTimeUpdate:l,showOverlay:c}=e;const o=Object(n.useRef)(null),[s,i]=Object(n.useState)(null),[d,p]=Object(n.useState)({width:0,height:0}),h=()=>{const e=o.current;e&&e.videoWidth>0&&e.videoHeight>0&&p({width:e.videoWidth,height:e.videoHeight})};Object(n.useEffect)(()=>{const e=o.current;if(!e)return;let a;u.a.isSupported()?(a=new u.a,a.loadSource(t),a.attachMedia(e),a.on(u.a.Events.MANIFEST_PARSED,()=>{e.play(),h()}),a.on(u.a.Events.ERROR,(e,t)=>{console.error("HLS.js Error:",t)})):e.canPlayType("application/vnd.apple.mpegurl")?(e.src=t,e.addEventListener("loadedmetadata",()=>{e.play(),h()})):console.error("HLS is not supported in this browser.");const n=m()(e,{controls:!0,autoplay:!0,muted:!0,fluid:!0,preload:"auto"});i(n);return n.on("timeupdate",()=>{if(!n)return;const e=n.currentTime(),t=new Date(1e3*e).toISOString().replace(/[-:T]/g,"").split(".")[0],a="".concat(t.slice(0,8),"_").concat(t.slice(8));l(a)}),()=>{n&&n.dispose(),a&&a.destroy()}},[t,l]);return r.a.createElement("div",{className:"video-container"},r.a.createElement("div",{className:"video-wrapper"},r.a.createElement("video",{ref:o,className:"video-js vjs-default-skin vjs-big-play-centered",controls:!0,playsInline:!0}),c&&a.length>0&&r.a.createElement("div",{className:"overlay"},a.map((e,t)=>{const a=(e=>{var t;const{width:a,height:n}=d,r=null===(t=o.current)||void 0===t?void 0:t.getBoundingClientRect();if(!r||0===a||0===n)return e;const l=r.width/a,c=r.height/n;return e.map(e=>{let{x:t,y:a}=e;return{x:t*l,y:a*c}})})(e);return r.a.createElement("svg",{key:t,style:{position:"absolute",left:0,top:0,width:"100%",height:"100%"}},r.a.createElement("polygon",{points:a.map(e=>"".concat(e.x,",").concat(e.y)).join(" "),style:{fill:"none",stroke:"red",strokeWidth:2}}))}))))});var p=function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Timeline Component"))},h=a(44),g=a.n(h),E=(a(73),a(137));a(74);var y=function(){const[e,t]=Object(n.useState)(null),[a,l]=Object(n.useState)(null),[c,o]=Object(n.useState)("00:00:00"),[s,i]=Object(n.useState)("23:59:59"),[m,u]=Object(n.useState)([]),[d,p]=Object(n.useState)([]),[h,y]=Object(n.useState)(!1),b=Object(n.useRef)(null),f=Object(n.useRef)(null);return Object(n.useEffect)(()=>{const e=b.current,t=e.getContext("2d"),a=f.current,n=a.offsetWidth,r=a.offsetHeight;e.width=n,e.height=r,t.clearRect(0,0,e.width,e.height);const l=n/1920,c=r/1080;d.forEach(e=>{let{topLeft:a,bottomRight:n}=e;const r=a.x*l,o=a.y*c,s=(n.x-a.x)*l,i=(n.y-a.y)*c;t.strokeStyle="red",t.lineWidth=2,t.strokeRect(r,o,s,i)})},[d]),r.a.createElement("div",{className:"layout-wrapper"},r.a.createElement("div",{className:"image-container",ref:f},r.a.createElement("img",{src:"/beach2.PNG",alt:"Beach Scene",className:"responsive-image"}),r.a.createElement("canvas",{ref:b,style:{position:"absolute",top:0,left:0}})),r.a.createElement("div",{className:"left-panel"},r.a.createElement("h2",null,"\uacfc\uac70 \ub370\uc774\ud130 \uc870\ud68c"),r.a.createElement("div",{className:"datetime-picker"},r.a.createElement("label",null,"\uc2dc\uc791 \ub0a0\uc9dc:"),r.a.createElement(g.a,{selected:e,onChange:e=>t(e),dateFormat:"yyyy-MM-dd",className:"custom-datepicker",placeholderText:"\uc2dc\uc791 \ub0a0\uc9dc\ub97c \uc120\ud0dd\ud558\uc138\uc694"})),r.a.createElement("div",{className:"datetime-picker"},r.a.createElement("label",null,"\uc885\ub8cc \ub0a0\uc9dc:"),r.a.createElement(g.a,{selected:a,onChange:e=>l(e),dateFormat:"yyyy-MM-dd",className:"custom-datepicker",placeholderText:"\uc885\ub8cc \ub0a0\uc9dc\ub97c \uc120\ud0dd\ud558\uc138\uc694"})),r.a.createElement("div",{className:"datetime-picker"},r.a.createElement("label",null,"\uc2dc\uc791 \uc2dc\uac04:"),r.a.createElement("input",{type:"time",value:c,onChange:e=>o(e.target.value),timeFormat:"HH:mm:ss",className:"custom-timepicker"})),r.a.createElement("div",{className:"datetime-picker"},r.a.createElement("label",null,"\uc885\ub8cc \uc2dc\uac04:"),r.a.createElement("input",{type:"time",value:s,onChange:e=>i(e.target.value),timeFormat:"HH:mm:ss",className:"custom-timepicker"})),r.a.createElement("button",{onClick:()=>{if(!e||!a)return void alert("\ub0a0\uc9dc\ub97c \uc120\ud0dd\ud558\uc138\uc694!");if(e>a)return void alert("\uc2dc\uc791 \ub0a0\uc9dc\ub294 \uc885\ub8cc \ub0a0\uc9dc\ubcf4\ub2e4 \uba3c\uc800\uc5ec\uc57c \ud569\ub2c8\ub2e4.");y(!0);const t=6e4*e.getTimezoneOffset(),n=new Date(e.getTime()-t).toISOString().split("T")[0],r=new Date(a.getTime()-t).toISOString().split("T")[0],l=2===c.split(":").length?"".concat(c,":00"):c,o=2===s.split(":").length?"".concat(s,":00"):s;E.a.get("https://port-0-rip-lyuhc4uac61f92ea.sel4.cloudtype.app/ripList/period",{params:{start_date:n,start_time:l,end_date:r,end_time:o}}).then(e=>{const t=e.data,a=t.flatMap(e=>{if("string"!==typeof e.drawing){if(Array.isArray(e.drawing)&&4===e.drawing.length){const[t,a,n,r]=e.drawing;return[{topLeft:{x:t[0],y:t[1]},bottomRight:{x:n[0],y:n[1]}}]}return console.error("Invalid drawing format:",e.drawing),[]}try{const t=JSON.parse(e.drawing);if(Array.isArray(t)&&4===t.length){const[e,a,n,r]=t;return[{topLeft:{x:e[0],y:e[1]},bottomRight:{x:n[0],y:n[1]}}]}}catch(t){return console.error("Error parsing drawing:",t),[]}});p(a),u(t),y(!1)}).catch(e=>{console.error("Error fetching data:",e),y(!1)})},disabled:h,className:"custom-button"},h?"\ub370\uc774\ud130 \ubd88\ub7ec\uc624\ub294 \uc911...":"\ub370\uc774\ud130 \uc870\ud68c"),r.a.createElement("div",{className:"data-list"},r.a.createElement("h3",null,"\uae30\uac04 \ub0b4 \ubc1c\uc0dd \ub370\uc774\ud130 \uc815\ubcf4"),h?r.a.createElement("p",null,"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."):r.a.createElement("ul",{className:"scrollable-list"},m.length>0?m.map((e,t)=>r.a.createElement("li",{key:t},t+1,". ",e.dateTime," (Bounding Count: ",e.boundingCount,")")):r.a.createElement("p",null,"\ud45c\uc2dc\ud560 \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."))),r.a.createElement("button",{className:"download-button"},"\ub2e4\uc6b4\ub85c\ub4dc")))},b=a(138);var f=function(){const[e,t]=Object(n.useState)([]),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>(a.current||(a.current=new b.a({brokerURL:"ws://port-0-rip-lyuhc4uac61f92ea.sel4.cloudtype.app/ws",reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onConnect:()=>{console.log("WebSocket connection established."),a.current.subscribe("/topic/ripData",e=>{const a=JSON.parse(e.body);if(console.log("Received message:",a),a.drawing){const e=a.drawing.map(e=>[{x:e[0][0],y:e[0][1]},{x:e[1][0],y:e[1][1]},{x:e[2][0],y:e[2][1]},{x:e[3][0],y:e[3][1]}]);t(e)}})},onStompError:e=>{console.error("Broker reported error: "+e.headers.message),console.error("Additional details: "+e.body)},onWebSocketClose:e=>{console.error("WebSocket connection closed: ",e)},onWebSocketError:e=>{console.error("WebSocket error: ",e)}}),a.current.activate()),()=>{a.current&&(a.current.deactivate(),console.log("WebSocket connection closed on cleanup."))}),[]),r.a.createElement(o.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(o.b,{to:"/",style:e=>{let{isActive:t}=e;return{fontWeight:t?"bold":"normal"}},end:!0},"\uc2e4\uc2dc\uac04 \uc601\uc0c1")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/pastData",style:e=>{let{isActive:t}=e;return{fontWeight:t?"bold":"normal"}}},"\uacfc\uac70 \ub370\uc774\ud130 \uc870\ud68c"))))),r.a.createElement("main",{className:"main-content"},r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",element:r.a.createElement(d,{src:"http://4.217.235.155/stream/index.m3u8",coordinates:e,showOverlay:!0})}),r.a.createElement(s.a,{path:"/pastData",element:r.a.createElement(y,null)}))),r.a.createElement("footer",null,r.a.createElement(p,null))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(f,null)),document.getElementById("root"))},52:function(e,t,a){e.exports=a(131)},57:function(e,t,a){},58:function(e,t,a){},60:function(e,t){},72:function(e,t,a){},74:function(e,t,a){}},[[52,1,2]]]);
//# sourceMappingURL=main.1e8b4288.chunk.js.map